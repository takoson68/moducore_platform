# 新增模組步驟

> 範例以 `foo` 模組為例，請替換成你的實際名稱。

1. **建立資料夾**
   - 在 `src/modules/` 下新增 `foo/`，至少放 `index.js`、`routes.js`、`pages/`。
2. **宣告模組資訊** (`src/modules/foo/index.js`)
   - 匯出 `default` 物件，包含 `name` 與 `setup`。
   - `setup.routes`：路由陣列（通常從 `routes.js` 匯入）。
   - `setup.stores`：可選，使用 store factory（依現有模組寫法）。
3. **定義路由** (`src/modules/foo/routes.js`)
   - 每個 route 的 `meta.public`、`meta.auth` 必須為布林值，缺少會丟錯。
   - 導覽列需要顯示的頁面，加入 `meta.nav`（`label`、`order`、`parent`）。
   - 若是巢狀路由，`parent` 填絕對路徑（`/foo` 形式），`createRegister` 會自動展平並注入路由。
4. **頁面放置** (`src/modules/foo/pages/`)
   - 建立對應的 `.vue` 頁面，路由 `component` 用動態匯入，例如 `() => import('./pages/home.vue')`。
5. **確認自動載入** (`src/modules/index.js`)
   - 目前使用 `import.meta.glob('./*/index.js')` 自動掃描，不需手動新增 loader。
   - `_archive` 內的模組會被排除。

6. **啟用模組** (`src/app/config/platform/platformMock.json`)
   - 在 `modules` 陣列加入 `"foo"`。
   - `npm run prebuild` 會產生 `platformMock.generated.json`，boot 時依 allowList 安裝。
   
7. **重啟開發伺服器**
   - 停止並重新執行 `npm run dev`（或重跑 build），確保路由與 nav 重新載入。
8. **驗證**
   - 確認登入/未登入狀態下路由可訪問、導覽列顯示符合 `meta` 設定。
